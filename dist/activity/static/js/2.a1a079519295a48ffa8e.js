webpackJsonp([2],{"4+Jz":function(t,a){},RqUp:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("//Fk"),s=e.n(i),n=e("Xxa5"),r=e.n(n),c=e("exGp"),o=e.n(c),l=e("oyxo"),u={metaInfo:{title:"活动相册"},mixins:[e("stRE").a],data:function(){return{logo:'this.src="'+e("bzac")+'"',info:{atlas_id:"",in_time:1,page:"",page_size:""},imgInfo:{},imgArr:[]}},methods:{getImage:function(){var t=this;l.b.post("/index.php?app=activity&m=act&cmd=106",{data:this.info}).then(function(a){if(0===a.errcode)for(var e in t.imgInfo=a.info,a.info.data)for(var i in a.info.data[e])t.imgArr.push(a.info.data[e][i].url)})},uploadImg:function(){var t=this;return o()(r.a.mark(function a(){var e,i,s;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.jssdkChooseImg();case 2:e=a.sent,a.t0=r.a.keys(e);case 4:if((a.t1=a.t0()).done){a.next=12;break}return i=a.t1.value,a.next=8,t.jssdkUploadImg(e[i]);case 8:s=a.sent,t.getToServer(s),a.next=4;break;case 12:case"end":return a.stop()}},a,t)}))()},jssdkChooseImg:function(){return new s.a(function(t,a){wx.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(a){var e=a.localIds;t(e)},fail:function(t){weui.topTips(t.errMsg,3e3)}})})},previewImage:function(t){wx.previewImage({current:t,urls:this.imgArr})},jssdkUploadImg:function(t){return new s.a(function(a,e){wx.uploadImage({localId:t,isShowProgressTips:1,success:function(t){var e=t.serverId;a(e)},fail:function(t){weui.topTips(t.errMsg,3e3)}})})},getToServer:function(t){var a=this;l.b.post("/index.php?app=activity&m=act&cmd=202",{data:{media_id:t}}).then(function(t){a.saveAcImg(t.data)})},saveAcImg:function(t){l.b.post("/index.php?app=activity&m=act&cmd=113",{data:{atlas_id:this.info.atlas_id,file:{file_name:"activityImg",file_url:t.path,file_key:t.file_hash,file_ext:t.ext}}}).then(function(t){0===Number(t.errcode)?weui.alert("上传成功，待审核"):weui.alert("上传失败")})},getMessage:function(){var t=location.href;l.b.post("/index.php?app=activity&m=act&cmd=201",{data:{url:t}}).then(function(t){})}},created:function(){this.getMessage(),l.c.initJssdkCon(["chooseImage","previewImage","uploadImage"]),this.info.atlas_id=this.$route.params.atlas_id,this.getImage()}},m={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"activityAlbum"},[e("div",{staticClass:"background_album"},[e("img",{attrs:{src:t.imgInfo.atlas_pic,onerror:t.logo,alt:"",srcset:""}})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],staticClass:"album_item"},t._l(t.imgInfo.data,function(a,i){return e("div",{key:i,staticClass:"item"},[e("div",{staticClass:"title clearfix"},[e("span",{staticClass:"item_time"},[t._v(t._s(i))]),t._v(" "),e("span",{staticClass:"item_count"},[t._v(t._s(a.length)+"张")])]),t._v(" "),e("div",{staticClass:"album"},[e("ul",{staticClass:"clearfix"},t._l(a,function(a,i){return e("li",{key:i},[e("img",{attrs:{src:a.url,alt:"",onerror:t.logo,srcset:""},on:{click:function(e){t.previewImage(a.url)}}})])}))])])})),t._v(" "),"0"===t.imgInfo.count?e("div",{staticClass:"not_album"},[t._m(0),t._v(" "),e("p",{staticClass:"not_pt"},[t._v("相册暂无图片")]),t._v(" "),e("p",{staticClass:"upd_pt"},[t._v("你可以直接点击下面按钮上传图片或者进入我的相册审核已上传的图片")])]):t._e(),t._v(" "),e("a",{staticClass:"weui-btn weui-btn_primary btn",attrs:{href:"javascript:;"},on:{click:t.uploadImg}},[t._v("上传照片")])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"icon"},[a("div",{staticClass:"img"},[a("span",{staticClass:"rulericon rulericon-camera"}),this._v(" "),a("span",{staticClass:"rulericon rulericon-image"}),this._v(" "),a("span",{staticClass:"rulericon rulericon-image"})])])}]};var f=e("VU/8")(u,m,!1,function(t){e("4+Jz")},"data-v-87b2fd70",null);a.default=f.exports}});